app-id: net.waterfox.waterfox
runtime: org.freedesktop.Platform
runtime-version: "22.08"
sdk: org.freedesktop.Sdk
command: waterfox
finish-args:
  - "--share=ipc"
  - "--socket=wayland"
  - "--filesystem=xdg-download:rw"
  - "--persist=.waterfox"
  - "--share=network"
  - "--socket=pulseaudio"
  - "--device=all"
  - "--talk-name=org.freedesktop.Notifications"
modules:
  - shared-modules/dbus-glib/dbus-glib.json
  - name: waterfox
    buildsystem: simple
    build-commands:
      - mkdir /app/opt
      - cp -r waterfox/ /app/opt/waterfox
      - desktop-file-install --dir /app/share/applications net.waterfox.waterfox.desktop
      - install -Dm644 /app/opt/waterfox/browser/chrome/icons/default/default256.png /app/share/icons/hicolor/256x256/apps/net.waterfox.waterfox.png
      - install -Dm644 net.waterfox.waterfox.appdata.xml -t /app/share/appdata
      - install -Dm644 flatpak-prefs.js -t /app/opt/waterfox/browser/defaults/preferences/
      - ln -sf /app/opt/waterfox/waterfox-bin /app/bin/waterfox
    sources:
      - type: archive
        url: https://cdn1.waterfox.net/waterfox/releases/G5.1.2/Linux_x86_64/waterfox-G5.1.2.tar.bz2
        sha256: 0a570f0eae2d623980a72bba5bf1d9ee1d80be31732e33784988e19b3fa16187
        dest: "waterfox"
      - type: file
        path: net.waterfox.waterfox.appdata.xml
      - type: file
        path: net.waterfox.waterfox.desktop
      - type: file
        path: flatpak-prefs.js